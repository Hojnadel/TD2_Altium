/*
===============================================================================
 Name        : eqh.c
 Author      : $(author)
 Version     :
 Copyright   : $(copyright)
 Description : main definition
===============================================================================
*/


#include <header.h>


int main(void)
{
	main_init();


	#if USE_RTOS

		// Start the scheduler
		vTaskStartScheduler();

		// Should never arrive here
		return 1;

	#else
		while(1)
		{
		}
	#endif

	while(1);

    return 0;
}















///***************************************************************************
// * 							DEFINES
// ***************************************************************************/
//// ** inicializacion de FFT
//#define	FFT_N					2048
//#define	FFT_DO_IFFT				FALSE
//#define	FFT_BIT_REVERSE			TRUE
//
////** Inicializacion de señal de entrada
//#define	X_SIZE					FFT_N
//#define	X_AMPLITUDE				1.0
//#define	X_FS					51200.0
//#define	X_FREC					1000.0
//
//
//
///***************************************************************************
// * 							INCLUDES
// ***************************************************************************/
//#include "header.h"
//
//
//
//
///***************************************************************************
// * 							VARIABLES GLOBALES
// ***************************************************************************/
////Vector de señal de entrada
//float x[FFT_N]
//		 __attribute__ ((section (".bss.$RamAHB32")));
//
////Ventana FlatTop
////const float w[FFT_N] = {0.004,0.0039811,0.0039243,0.0038296,0.0036965,0.0035248,0.0033141,0.0030637,0.0027729,0.0024411,0.0020674,0.0016508,0.0011902,0.00068468,0.00013286,-0.00046651,-0.0011148,-0.0018135,-0.002564,-0.0033681,-0.0042273,-0.0051434,-0.006118,-0.0071532,-0.0082506,-0.0094123,-0.01064,-0.011936,-0.013302,-0.01474,-0.016252,-0.017841,-0.019507,-0.021254,-0.023083,-0.024996,-0.026995,-0.029081,-0.031258,-0.033526,-0.035887,-0.038343,-0.040895,-0.043545,-0.046295,-0.049144,-0.052096,-0.05515,-0.058308,-0.061569,-0.064936,-0.068408,-0.071985,-0.075668,-0.079457,-0.08335,-0.087348,-0.09145,-0.095655,-0.099962,-0.10437,-0.10887,-0.11348,-0.11817,-0.12296,-0.12784,-0.1328,-0.13785,-0.14298,-0.14818,-0.15345,-0.15879,-0.16419,-0.16964,-0.17515,-0.1807,-0.18629,-0.19191,-0.19755,-0.20321,-0.20888,-0.21455,-0.22022,-0.22586,-0.23149,-0.23707,-0.24261,-0.2481,-0.25352,-0.25887,-0.26412,-0.26927,-0.27432,-0.27923,-0.28401,-0.28864,-0.29311,-0.29739,-0.30148,-0.30537,-0.30904,-0.31247,-0.31564,-0.31855,-0.32118,-0.32351,-0.32552,-0.3272,-0.32854,-0.32951,-0.33009,-0.33028,-0.33005,-0.32939,-0.32828,-0.3267,-0.32463,-0.32206,-0.31897,-0.31534,-0.31116,-0.3064,-0.30106,-0.2951,-0.28852,-0.2813,-0.27342,-0.26487,-0.25562,-0.24567,-0.235,-0.22359,-0.21143,-0.19849,-0.18478,-0.17027,-0.15496,-0.13882,-0.12185,-0.10403,-0.085355,-0.065812,-0.045391,-0.024083,-0.0018779,0.021232,0.045253,0.070194,0.096059,0.12285,0.15058,0.17925,0.20886,0.23941,0.27091,0.30335,0.33673,0.37105,0.40632,0.44252,0.47965,0.51771,0.55668,0.59657,0.63736,0.67905,0.72162,0.76506,0.80936,0.85451,0.90049,0.94729,0.99488,1.0433,1.0924,1.1423,1.1929,1.2442,1.2962,1.3488,1.4021,1.456,1.5104,1.5654,1.621,1.677,1.7335,1.7904,1.8477,1.9054,1.9634,2.0218,2.0804,2.1392,2.1982,2.2574,2.3167,2.3761,2.4355,2.4949,2.5543,2.6136,2.6728,2.7319,2.7908,2.8494,2.9077,2.9658,3.0235,3.0807,3.1376,3.1939,3.2498,3.305,3.3597,3.4137,3.467,3.5196,3.5714,3.6224,3.6725,3.7218,3.7702,3.8175,3.8639,3.9092,3.9535,3.9966,4.0386,4.0795,4.1191,4.1574,4.1945,4.2303,4.2648,4.2978,4.3295,4.3598,4.3887,4.416,4.4419,4.4663,4.4891,4.5104,4.5301,4.5483,4.5648,4.5797,4.593,4.6047,4.6147,4.623,4.6297,4.6348,4.6381,4.6398,4.6398,4.6381,4.6348,4.6297,4.623,4.6147,4.6047,4.593,4.5797,4.5648,4.5483,4.5301,4.5104,4.4891,4.4663,4.4419,4.416,4.3887,4.3598,4.3295,4.2978,4.2648,4.2303,4.1945,4.1574,4.1191,4.0795,4.0386,3.9966,3.9535,3.9092,3.8639,3.8175,3.7702,3.7218,3.6725,3.6224,3.5714,3.5196,3.467,3.4137,3.3597,3.305,3.2498,3.1939,3.1376,3.0807,3.0235,2.9658,2.9077,2.8494,2.7908,2.7319,2.6728,2.6136,2.5543,2.4949,2.4355,2.3761,2.3167,2.2574,2.1982,2.1392,2.0804,2.0218,1.9634,1.9054,1.8477,1.7904,1.7335,1.677,1.621,1.5654,1.5104,1.456,1.4021,1.3488,1.2962,1.2442,1.1929,1.1423,1.0924,1.0433,0.99488,0.94729,0.90049,0.85451,0.80936,0.76506,0.72162,0.67905,0.63736,0.59657,0.55668,0.51771,0.47965,0.44252,0.40632,0.37105,0.33673,0.30335,0.27091,0.23941,0.20886,0.17925,0.15058,0.12285,0.096059,0.070194,0.045253,0.021232,-0.0018779,-0.024083,-0.045391,-0.065812,-0.085355,-0.10403,-0.12185,-0.13882,-0.15496,-0.17027,-0.18478,-0.19849,-0.21143,-0.22359,-0.235,-0.24567,-0.25562,-0.26487,-0.27342,-0.2813,-0.28852,-0.2951,-0.30106,-0.3064,-0.31116,-0.31534,-0.31897,-0.32206,-0.32463,-0.3267,-0.32828,-0.32939,-0.33005,-0.33028,-0.33009,-0.32951,-0.32854,-0.3272,-0.32552,-0.32351,-0.32118,-0.31855,-0.31564,-0.31247,-0.30904,-0.30537,-0.30148,-0.29739,-0.29311,-0.28864,-0.28401,-0.27923,-0.27432,-0.26927,-0.26412,-0.25887,-0.25352,-0.2481,-0.24261,-0.23707,-0.23149,-0.22586,-0.22022,-0.21455,-0.20888,-0.20321,-0.19755,-0.19191,-0.18629,-0.1807,-0.17515,-0.16964,-0.16419,-0.15879,-0.15345,-0.14818,-0.14298,-0.13785,-0.1328,-0.12784,-0.12296,-0.11817,-0.11348,-0.10887,-0.10437,-0.099962,-0.095655,-0.09145,-0.087348,-0.08335,-0.079457,-0.075668,-0.071985,-0.068408,-0.064936,-0.061569,-0.058308,-0.05515,-0.052096,-0.049144,-0.046295,-0.043545,-0.040895,-0.038343,-0.035887,-0.033526,-0.031258,-0.029081,-0.026995,-0.024996,-0.023083,-0.021254,-0.019507,-0.017841,-0.016252,-0.01474,-0.013302,-0.011936,-0.01064,-0.0094123,-0.0082506,-0.0071532,-0.006118,-0.0051434,-0.0042273,-0.0033681,-0.002564,-0.0018135,-0.0011148,-0.00046651,0.00013286,0.00068468,0.0011902,0.0016508,0.0020674,0.0024411,0.0027729,0.0030637,0.0033141,0.0035248,0.0036965,0.0038296,0.0039243,0.0039811,0.004};
//
////Vector de la señal de entrada multiplicada en tiempo por la ventana
//float xw[FFT_N];
//
////Espectro de señal de entrada ventaneada
//float Xw[2*FFT_N];
//
//// Modulo del espectro de señal de entrada ventaneada
//float IXwI[FFT_N/2]
//		   __attribute__ ((section (".bss.$RamAHB32")));
//
//arm_rfft_instance_f32 instanceFFT;
//arm_cfft_radix4_instance_f32 instanceCFFT;
//
//
//
///***************************************************************************
// * 							FUNCIONES AUXILIARES
// ***************************************************************************/
///**
// * @fn getSine
// * @brief Obtengo un seno
// * @param amplitude Amplitud del seno
// * @param fSampling
// * @param fSine
// * @param size
// * @param buffer
// */
//void createSin(float amplitude, float fSampling, float fSine, uint32_t size, float *buffer)
//{
//	uint32_t i;
//
//	for(i = 0; i < size; i ++)
//	{
//		buffer[i] += amplitude * sinf(2 * PI * fSine * (float)i / fSampling);
//	}
//}
//
//
///**
// * @note Variables globales
// */
//
///**
// * @note Funciones publicas
// */
///**
// * @fn dspMatrix_ScalarMultiplication
// * @brief Calculo el producto interno de dos vectores.
// * @param a factor
// * @param b factor
// * @param c producto
// * @param size
// */
//void dspMatrix_ScalarMultiplication(float *a, float *b, float *c,  uint32_t size)
//{
//	uint32_t i;
//
//	for(i = 0; i < size; i++)
//	{
//		c[i] = a[i] * b[i];
//	}
//}
//
//
///**
// * @fn dspPower_ComplexParseval(float *x, uint32_t size)
// * @brief Calcula por Parseval la potencia de un vector de muestras en el dominio espectral complejo
// * @param x muestras
// * @param size tamaño del buffer
// * @return potencia de la señal
// */
//float dspPower_ComplexParseval(float *x, uint32_t size)
//{
//	uint32_t i;
//	float power = 0.0;
//
//	for(i = 0; i < size; i++)
//	{
//		power += (x[i] * x[i]);
//	}
//	return power;
//}
//
//
//
///***************************************************************************
// * 							MAIN
// ***************************************************************************/
//int main()
//{
//	/***************************************************************************
//	 * 							DECLARACIONES
//	 ***************************************************************************/
//
//
//
//	/***************************************************************************
//	 * 							INICIALIZACIONES
//	 ***************************************************************************/
//
//	if(arm_rfft_init_f32(&instanceFFT, &instanceCFFT, FFT_N, FFT_DO_IFFT, FFT_BIT_REVERSE) == ARM_MATH_ARGUMENT_ERROR)
//	{
//		while(1);
//	}
//
//
//	/***************************************************************************
//	 * 							CODIGO
//	 ***************************************************************************/
//
//	// Creo un seno para la señal de entrada
//	createSin(X_AMPLITUDE, X_FS, X_FREC, X_SIZE, x);
//
//	// Creo un seno para la señal de entrada
//	createSin(X_AMPLITUDE, X_FS, X_FREC*2, X_SIZE, x);
//
//	// Creo un seno para la señal de entrada
//	createSin(X_AMPLITUDE, X_FS, X_FREC*4, X_SIZE, x);
//
//	// Ventaneo señal de entrada en tiempo
////	dspMatrix_ScalarMultiplication(x, w, xw,  FFT_N);
//
//	// Obtengo espectro de señal ventaneada
//	arm_rfft_f32(&instanceFFT, x, Xw);
//
//	//Obtengo la potencia de la señal en el espectro
//	arm_cmplx_mag_f32(Xw, IXwI, FFT_N/2);
//
//
//	while(1);
//
//
//	return 0;
//}
